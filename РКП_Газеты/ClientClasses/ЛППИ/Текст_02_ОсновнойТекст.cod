class "";

inclass



  proc Создание(ЛППИ            : TextFile;
                ЗаписьЛППИ      : Record);
    var k,j                     : integer;
    var txt,sim                 : string;
    var Q                       : Query;
      Q                         = Query.Create([РКП_Газеты.Газета]);
      Q.Filter                  = "ГодЛетописи="+Str(ЗаписьЛППИ.ГодЛетописи);
      Q.Order                   = "ЗаписьВЛетописи";
      Q.Select;
      Q.First;
      for k = 1..Q.Count                        do
        Hint("Создание текста...",k,Q.Count);
----------------------------------------------------------------------------
        if Q.Current.ОписаниеГазеты<>nil        then
          if Q.Current.НомерВЛетописи>0         then
            ЛППИ.Write  (Str(Q.Current.НомерВЛетописи)+". ");
            ЛППИ.Write  ("/*"+Q.Current.Заголовок+"*/");
            txt = Q.Current.ОписаниеГазеты;
              for j=1..Length(txt)              do
                sim = SubStr(txt,j,1);
                if Ord(sim)<>13                 then
            ЛППИ.Write  (sim);
                else
            ЛППИ.WriteLn("");
                end;
              if j=Length(txt)                  then
            ЛППИ.WriteLn("");
              end;
            end;
          else
            ЛППИ.Write  ("/*"+Q.Current.Заголовок+"*/");
            txt = Q.Current.ОписаниеГазеты;
            for j=1..Length(txt)                do
              sim = SubStr(txt,j,1);
              if Ord(sim)<>13                   then
            ЛППИ.Write  (sim);
              else
            ЛППИ.WriteLn("");
              end;
              if j=Length(txt)                  then
            ЛППИ.WriteLn("");
              end;
            end;
          end;
        end;
        Q.Next;
      end;  --for
      Q.Close;
  end;

inobject

end