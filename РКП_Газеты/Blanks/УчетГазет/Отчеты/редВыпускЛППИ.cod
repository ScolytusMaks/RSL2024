class inherited УчетГазет.Отчеты.РедВыпускЛППИ_03 "выпуск ЛППИ", editor ВыпускЛППИ;

inobject private

--{{ 2_Свойства
  var секцУказательТематик :TemplateSection;
  var секцМестаИздания     :TemplateSection;
  var секцУказательМест    :TemplateSection;
  var секцУказательАдм     :TemplateSection;
  var секцИерархияРФ       :TemplateSection;
--}}


-- 2_Обработчики событий клеток шаблона0. --

  func ОбновитьНумерацию(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    РКП_Газеты.ЛППИ.НумерацияСтатей.Выполнение(ГодЛетописи);
    Result = True; 
  end;

  func ОбновитьОписание (Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    var Q : Query;
    var k : integer;
    var Заголовок_      : string;
    var ОписаниеГазеты_ : string;
        Q               = Query.Create([РКП_Газеты.Газета]);
        Q.Filter        = "ГодЛетописи="+Str(ГодЛетописи);
        Q.Select;
        Q.First;
        for k = 1..Q.Count      do
          Hint("",k,Q.Count);
          if CmOk=РКП_Газеты.ЛППИ.БибСтатья.2Создание0(Q.Current,Заголовок_,ОписаниеГазеты_)       then
            Q.Current.Заголовок         = Заголовок_;
            Q.Current.ОписаниеГазеты    = ОписаниеГазеты_;
            if Q.Current.State = Record.Edited                  then
              Q.Current.Post;
            end;
          end;
          Q.Next;
        end;
        Q.Close;
    Result = True; 
  end;

  func СоздатьВыпуск(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    var ЛППИ :TextFile;
    ----Создание файла-----
    РКП_Газеты.ЛППИ.Текст_01_Файл.Создание(ПапкаЛППИ, ФайлЛППИ, ЛППИ);
    РКП_Газеты.ЛППИ.Текст_02_ОсновнойТекст.Создание(ЛППИ, Record);
    СозданиеСистУказателя;
    СозданиеМестУказателя;
    СозданиеАдмУказателя;
    СозданиеЯзУказателя;
    Result = True; 
  end;

  func ПросмотрКарточек(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    РКП_Газеты.УчетГазет.блкартГазетыЛППИ.ПоказатьСоставЛППИ(ГодЛетописи);
  end;

  func ОткрытьОригиналМакетIn(Cell :TemplateCell; Action :Template.ClickTypes):Logical;
    OpenEditor(ФайлЛППИ);--отладка
    Result = True; 
  end;

  func ОткрытьОригиналМакетOut(Cell :TemplateCell; Action :Template.ClickTypes):Logical;
    ExecuteProgram(ФайлЛППИ);
    Result = True; 
  end;

  func ОткрытьОригиналМакетFold(Cell :TemplateCell; Action :Template.ClickTypes):Logical;
    ExecuteProgram(ПапкаЛППИ);
    Result = True; 
  end;

  proc ПолеВыпускСверстанПриВыходе(Cell :TemplateCell; Index :Integer);
  end;


end