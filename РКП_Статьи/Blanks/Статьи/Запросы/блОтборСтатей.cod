class inherited —»—2.ЅазовыйЅланк "‘ильтр реестра статей";
inclass


inobject

секц”слови€ќтбора       : section;
Edit1                   : Object;

«аголовок—татьи         : string;       --«аголовок—татьи¬ар              : integer;
—одержание—татьи        : string;       --—одержание—татьи¬ар             : integer;
Ќазвание—татьи          : string;       --Ќазвание—татьи¬ар               : integer;
јвтор—татьи             : string;       --јвтор—татьи¬ар                  : integer;
ћесто»здани€√азеты      : string;       --ћесто»здани€√азеты—татьи¬ар     : integer;
√азета                  : string;       --√азета¬ар                       : integer;

√од√азеты—              : integer;
√од√азетыѕо             : integer;

Ќомер√азеты             : string;
ЌедостающиеЌомера       : integer;
”ƒ                      : string;       --”ƒ ¬ар                          : integer;
ЅЅ                      : string;
¬“–                     : string;
√ео–убрика              : string;       --√ео–убрика¬ар                   : integer;
—истѕод–убрика          : string;       --—истѕод–убрика¬ар               : integer;
ƒата¬вода—              : string;
ƒата¬водаѕо             : string;
¬ыпускЋ√—год            : integer;
¬ыпускЋ√—номер          : integer;
¬ыпускѕ                 : integer;
----------

‘ильтр—татей:string;


--------------------------------------------------------------------------------
--{ ќбработчики событий бланка

  proc шаблон_ѕриќткрытии(Create :Logical);
    inherited шаблон_ѕриќткрытии(Create);
    секц”слови€ќтбора.Cell[3,1].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,2].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,4].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,5].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,6].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,7].Contents  = "фрагмент";
    секц”слови€ќтбора.Cell[3,12].Contents = "фрагмент";
    секц”слови€ќтбора.Cell[3,13].Contents = "фрагмент";
    секц”слови€ќтбора.Cell[3,14].Contents = "фрагмент";
    --
    секц”слови€ќтбора.Cell[2,2].Contents  = "и";
    секц”слови€ќтбора.Cell[2,4].Contents  = "и";
    секц”слови€ќтбора.Cell[2,5].Contents  = "и";
    секц”слови€ќтбора.Cell[2,6].Contents  = "и";
    секц”слови€ќтбора.Cell[2,7].Contents  = "и";
    секц”слови€ќтбора.Cell[2,8].Contents  = "и";
    секц”слови€ќтбора.Cell[2,10].Contents = "и";
    секц”слови€ќтбора.Cell[2,11].Contents = "и";
    секц”слови€ќтбора.Cell[2,12].Contents = "и";
    секц”слови€ќтбора.Cell[2,13].Contents = "и";
    секц”слови€ќтбора.Cell[2,14].Contents = "и";
    секц”слови€ќтбора.Cell[2,15].Contents = "и";
    секц”слови€ќтбора.Cell[2,17].Contents = "и";
    секц”слови€ќтбора.Cell[2,18].Contents = "и";
    секц”слови€ќтбора.Cell[2,19].Contents = "и";
    секц”слови€ќтбора.Cell[2,20].Contents = "и";
    секц”слови€ќтбора.Cell[2,21].Contents = "и";
    --
    секц”слови€ќтбора.Cell[4,11].Contents = "<¬се>";
    --
    «аголовок—татьи                     = "<¬се>";
    —одержание—татьи                    = "<¬се>";
    Ќазвание—татьи                      = "<¬се>";
    јвтор—татьи                         = "<¬се>";
    ћесто»здани€√азеты                  = "<¬се>";
    √азета                              = "<¬се>";
    √од√азеты—                          = 0 ;
    √од√азетыѕо                         = Year(today) ;
    ƒата¬вода—                          = "<Ћюба€>";
    ƒата¬водаѕо                         = Str(today);
    Ќомер√азеты                         = "<¬се>";
    ЌедостающиеЌомера                   = 0;
    ”ƒ                                  = "<¬се>";
    ¬“–                                 = "<¬се>";
    ЅЅ                                  = "<¬се>";
    √ео–убрика                          = "<¬се>";
    —истѕод–убрика                      = "<¬се>";
    --
    ¬ыпускЋ√—год                        = 0 ;
    ¬ыпускЋ√—номер                      = 0 ;
    ¬ыпускѕ                             = 0 ;
    --
    ‘ильтр—татей                        = nil;
  end;







  proc —оздать‘ильтр—татей;
  var Sec               : Section;
  var ‘рагмент‘ильтра   : String;
    Sec                 = секц”слови€ќтбора;
    --====================================================== заголовок статьи Ћ√— 1 ==
    ‘ильтр—татей        = nil;
    if «аголовок—татьи<>"<¬се>"                         then
      if        Sec.Cell[3,1].Contents  = "фрагмент"    then
                ‘ильтр—татей = 'Match(«аголовок,"*'+«аголовок—татьи+'*")';
      else
                ‘ильтр—татей = 'Match(«аголовок,"'+«аголовок—татьи+'*")';
      end;
    end;        -- «аголовок—татьи<>"<¬се>"
    --====================================================== содержание статьи Ћ√— 2 ==
    ‘рагмент‘ильтра = "";
    if —одержание—татьи<>"<¬се>"                        then
      if        Sec.Cell[3,2].Contents  = "фрагмент"    then
                ‘рагмент‘ильтра = 'Match(ќписание—татьи,"*'+—одержание—татьи+'*")';
      else
                ‘рагмент‘ильтра = 'Match(ќписание—татьи,"'+—одержание—татьи+'*")';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,2].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,2].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,2].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- —одержание—татьи<>"<¬се>"
  --====================================================== название статьи 3 ==
    ‘рагмент‘ильтра = "";
    if Ќазвание—татьи<>"<¬се>"                          then
      if        Sec.Cell[3,4].Contents  = "фрагмент"    then
                ‘рагмент‘ильтра = 'Match(Ќазвание—татьи,"*'+Ќазвание—татьи+'*")';
      else
                ‘рагмент‘ильтра = 'Match(Ќазвание—татьи,"'+Ќазвание—татьи+'*")';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,4].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,4].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,4].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== первые сведени€ 5 ==
    ‘рагмент‘ильтра = "";
    if јвтор—татьи<>"<¬се>"                             then
      if        Sec.Cell[3,5].Contents  = "фрагмент"    then
                ‘рагмент‘ильтра = '(Match(јвтор‘амили€,"*'+јвтор—татьи+'*")'+' or '+
                                   'Match(ѕќ_Ќаименование.Ќаим,"*'+јвтор—татьи+'*")'+' or '+
                                   'Match(¬ќ_Ќаименование.Ќаим,"*'+јвтор—татьи+'*"))';
      else
                ‘рагмент‘ильтра = '(Match(јвтор‘амили€,"'+јвтор—татьи+'*")'+' or '+
                                   'Match(ѕќ_Ќаименование.Ќаим,"'+јвтор—татьи+'*")'+' or '+
                                   'Match(¬ќ_Ќаименование.Ќаим,"'+јвтор—татьи+'*"))';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,5].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,5].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,5].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== место издани€ газеты 6 ==
    ‘рагмент‘ильтра = "";
    if ћесто»здани€√азеты<>"<¬се>"                      then
      if        Sec.Cell[3,6].Contents  = "фрагмент"    then
                ‘рагмент‘ильтра = 'Match(ћесто»здани€,"*'+ћесто»здани€√азеты+'*")';
      else
                ‘рагмент‘ильтра = 'Match(ћесто»здани€,"'+ћесто»здани€√азеты+'*")';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,6].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,6].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,6].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== название газеты 7 ==
    ‘рагмент‘ильтра = "";
    if √азета<>"<¬се>"                                  then
      if        Sec.Cell[3,7].Contents  = "фрагмент"    then
                ‘рагмент‘ильтра = 'Match(Ќазваниеќсн,"*'+√азета+'*")';
      else
                ‘рагмент‘ильтра = 'Match(Ќазваниеќсн,"'+√азета+'*")';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,7].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,7].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,7].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== годы издани€ 8-9 ==
    ‘рагмент‘ильтра = "";
    if √од√азеты—<>0 or √од√азетыѕо<>0                  then
                ‘рагмент‘ильтра = 'Ќомера√азеты.Exists'+
                                  '(√од¬ыпуска>='+Str(√од√азеты—)+
                                  ' and √од¬ыпуска<='+Str(√од√азетыѕо)+
                                  ')';
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,8].Contents  = "и"           then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,8].Contents  = "или"         then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,8].Contents  = "не"          then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- непустое условие
  --====================================================== номер газеты 10 ==
    ‘рагмент‘ильтра = "";
    if Ќомер√азеты<>"<¬се>"                             then
                ‘рагмент‘ильтра = 'Ќомера√азеты.Exists'+'(Ќомер="'+Ќомер√азеты+'")';
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,10].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,10].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,10].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== регистраци€ номеров 11 ==
    ‘рагмент‘ильтра = "";
    if Sec.Cell[4,11].Contents <>"<¬се>"                then
      if    Sec.Cell[4,11].Contents = "<“олько зарегистрированные>"     then
                ‘рагмент‘ильтра = 'Ќомера√азеты.Exists(Ќомер√азеты.ƒатаѕрин€ти€Ќа’ранение>01.01.1901)';
      elsif Sec.Cell[4,11].Contents = "<“олько Ќ≈ зарегистрированные>"  then
                ‘рагмент‘ильтра = 'Ќомера√азеты.Exists(Ќомер√азеты.ƒатаѕрин€ти€Ќа’ранение<=01.01.1901)';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,11].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,11].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,11].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== код ”ƒ  12 ==
    ‘рагмент‘ильтра = "";
    if ”ƒ <>"<¬се>"                                     then
      if        Sec.Cell[3,12].Contents  = "фрагмент"   then
                ‘рагмент‘ильтра = "»ндекс”ƒ .Exists(Match(–убрика”ƒ . од,'*"+”ƒ +"*'))";
      else
                ‘рагмент‘ильтра = "»ндекс”ƒ .Exists(Match(–убрика”ƒ . од,'"+”ƒ +"*'))";
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,12].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,12].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,12].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --================================¬ременна€ тематическа€ рубрика 13 ====
    ‘рагмент‘ильтра = "";
    if ¬“–<>"<¬се>"                                     then
      if        Sec.Cell[3,13].Contents  = "фрагмент"   then
                ‘рагмент‘ильтра = "Match(»ндекс¬“–. рЌаим,'*"+¬“–+"*')";
      else
                ‘рагмент‘ильтра = "Match(»ндекс¬“–. рЌаим,'"+¬“–+"*')";
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,13].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,13].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,13].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== код ЅЅ  14 ====
    ‘рагмент‘ильтра = "";
    if ЅЅ <>"<¬се>"                                     then
      if        Sec.Cell[3,14].Contents  = "фрагмент"   then
                ‘рагмент‘ильтра = "»ндексЅЅ .Exists(Match(–убрикаЅЅ . од,'*"+ЅЅ +"*'))";
      else
                ‘рагмент‘ильтра = "»ндексЅЅ .Exists(Match(–убрикаЅЅ . од,'"+ЅЅ +"*'))";
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,14].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,14].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,14].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== географическа€ рубрика 15 ==
    ‘рагмент‘ильтра = "";
    if √ео–убрика<>"<¬се>"                              then
      if        Sec.Cell[3,15].Contents  = "фрагмент"   then
                ‘рагмент‘ильтра = '»ндекс√ео.Exists(Match(–убрика√ео.Ќаим,"*'+√ео–убрика+'*"))';
      else
                ‘рагмент‘ильтра = '»ндекс√ео.Exists(Match(–убрика√ео.Ќаим,"'+√ео–убрика+'*"))';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,15].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,15].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,15].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== систематическа€ подрубрика 16 ==
    ‘рагмент‘ильтра = "";
    if —истѕод–убрика<>"<¬се>"                          then
      if        Sec.Cell[3,16].Contents  = "фрагмент"   then
                ‘рагмент‘ильтра = '»ндекс√ео.Exists(Match(ѕод–убрика—ист. рЌаим,"*'+—истѕод–убрика+'*"))';
      else
                ‘рагмент‘ильтра = '»ндекс√ео.Exists(Match(ѕод–убрика—ист. рЌаим,"'+—истѕод–убрика+'*"))';
      end;
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,16].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,16].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,16].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== даты ввода 17-18 ==
    ‘рагмент‘ильтра = "";
    if ƒата¬вода—<>"<Ћюба€>" or ƒата¬водаѕо<>"<Ћюба€>"          then
      if    ƒата¬вода—<>"<Ћюба€>" and ƒата¬водаѕо<>"<Ћюба€>"    then
                ‘рагмент‘ильтра = '(CreateDate>='+Str(StringToDate(ƒата¬вода—))+
                                  ' and CreateDate<'+Str(StringToDate(ƒата¬водаѕо)+1)+
                                  ')';
      elsif ƒата¬вода—="<Ћюба€>" and ƒата¬водаѕо<>"<Ћюба€>"     then
                ‘рагмент‘ильтра = 'CreateDate<'+Str(StringToDate(ƒата¬водаѕо)+1);
      elsif ƒата¬вода—<>"<Ћюба€>" and ƒата¬водаѕо="<Ћюба€>"     then
                ‘рагмент‘ильтра = 'CreateDate>='+ƒата¬вода—;
      end;
      if  ‘ильтр—татей <> nil                                   then
        if      Sec.Cell[2,17].Contents  = "и"                  then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,17].Contents  = "или"                then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,17].Contents  = "не"                 then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- непустое условие
  --====================================================== выпуск Ћ√— год 19 ==
    ‘рагмент‘ильтра = "";
    if ¬ыпускЋ√—год<>0                                  then
                ‘рагмент‘ильтра = '√одЋетописи='+Str(¬ыпускЋ√—год);
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,19].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,19].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,19].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== выпуск ѕ   номер 20 ==
    ‘рагмент‘ильтра = "";
    if ¬ыпускЋ√—номер<>0                                then
                ‘рагмент‘ильтра = '¬ыпускЋетописи='+Str(¬ыпускЋ√—номер);
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,20].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,20].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,20].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  --====================================================== выпуск каталожной карточки номер 21 ==
    ‘рагмент‘ильтра = "";
    if ¬ыпускѕ <>0                                      then
                ‘рагмент‘ильтра = '¬ыпуск арточек='+Str(¬ыпускѕ );
      if  ‘ильтр—татей <> nil                           then
        if      Sec.Cell[2,21].Contents  = "и"          then
                ‘рагмент‘ильтра         = "and ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,21].Contents  = "или"        then
                ‘рагмент‘ильтра         = "or ("+‘рагмент‘ильтра+")";
        elsif   Sec.Cell[2,21].Contents  = "не"         then
                ‘рагмент‘ильтра         = "and not ("+‘рагмент‘ильтра+")";
        end;
                ‘ильтр—татей            = ‘ильтр—татей+" "+‘рагмент‘ильтра;
      else      -- ‘ильтр—татей = nil
                ‘ильтр—татей = ‘рагмент‘ильтра;
      end;      -- ‘ильтр—татей <> nil
    end;        -- <>"<¬се>"
  end;          -- proc —оздать‘ильтр—татей


  func CellOnClick(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    if          Cell.Column             = 3             then
      if        Cell.Contents           = "фрагмент"    then
                Cell.Contents           = "начало";
      else      Cell.Contents           = "фрагмент";
      end;
    elsif       Cell.Column             = 2             then
      if        Cell.Contents           = "и"           then
                Cell.Contents           = "или";
      elsif     Cell.Contents           = "или"         then
                Cell.Contents           = "не";
      else      Cell.Contents           = "и";
      end;
    elsif       Cell.Column             = 4             then
      if        Cell.Contents           = "<¬се>"       then
                Cell.Contents           = "<“олько зарегистрированные>";
      elsif     Cell.Contents           = "<“олько зарегистрированные>"                 then
                Cell.Contents           = "<“олько Ќ≈ зарегистрированные>";
      else      Cell.Contents           = "<¬се>";
      end;
    end;
    —оздать‘ильтр—татей;
    Result = True; -- –азрешаем стандартную обработку
  end;

  proc  нѕрименить_ѕриЌажатии(Sender :Button);
  var ObCrd : CardForm;
    inherited  нќ _ѕриЌажатии(Sender);
    —оздать‘ильтр—татей;
    ObCrd                       = – ѕ_—татьи.—татьи.карт–оспись—татей—ложн‘ильтр.Create;
    if √азета<>"<¬се>"          then
    ObCrd.‘рагментЌазвани€      = √азета;
    end;
    ObCrd.√од¬ыпуска            = ¬ыпускЋ√—год;
    ObCrd.Ќомер¬ыпуска          = ¬ыпускЋ√—номер;
    #NoWarning;
    ObCrd.ShowFormEx(nil,‘ильтр—татей,Window.ChildWindow);
  end;

  proc кнќчиститьѕриЌажатии(Sender :Button);
    шаблон_ѕриќткрытии(True);
  end;

  func ѕолеƒата¬водаѕриѕроверке(Cell :TemplateCell; Index :Integer;var Value :Variant) :Logical;
    var D_Value : date;
    var S_Value : string;
    try
      if  – ѕ_—»—.DateDescription.ѕроверить—троку(Value,S_Value) = true    then
        --проверка на корректность пары дат
        if          Cell.Contents = "ƒата¬вода—"                        then
          if  ƒата¬водаѕо < S_Value                                     then
            Message("ƒата начала периода ввода статьи в Ѕƒ превышает дату окончани€!");
            Return false;
          end;
        elsif       Cell.Contents = "ƒата¬водаѕо"                       then
          if  S_Value < ƒата¬вода—                                      then
            Message("ƒата начала периода ввода статьи в Ѕƒ превышает дату окончани€!");
            Return false;
          end;
        end;
        --
        D_Value = StringToDate(S_Value);
        Value = Str(Dat(1,Mon(D_Value),Year(D_Value)));
        S_Value=Value;
      else
        if Value<>nil           then
        —оздать‘ильтр—татей;
        Return false;
        else
        —оздать‘ильтр—татей;
        Return true;
        end;
      end;
    except
      —оздать‘ильтр—татей;
      Return false;
    end;
    —оздать‘ильтр—татей;
    Result = True; 
  end;

  func ѕолеƒата¬водаѕриќбзоре(Cell :TemplateCell; Value :Variant;var NewValue :Variant) :Logical;
    var dats            : Date;
    if          Cell.Contents = "ƒата¬вода—"    then
      if ƒата¬вода—<>nil                        then
        dats    = Calendar(StringToDate(ƒата¬вода—));
      else
        dats    = Calendar(today);
      end;
    elsif       Cell.Contents = "ƒата¬водаѕо"   then
      if ƒата¬водаѕо<>nil                       then
        dats    = Calendar(StringToDate(ƒата¬водаѕо));
      else
        dats    = Calendar(today);
      end;
    end;
    if  dats<>nil                               then
      NewValue = Str(dats);
      Template.EndEdit;
    end;
  2 0 2Return 0false2;
  end;


  proc ѕолеѕри¬ыходе(Cell :TemplateCell; Index :Integer);
    if Cell.FieldType = 2                       then
      if  Cell.Contents<>"ƒата¬вода—"           and
          Cell.Contents<>"ƒата¬водаѕо"          then
        if    Cell.Value = nil                  then
              Cell.Value = "<¬се>";
        end;
      else
        if    Cell.Value = nil                  then
              Cell.Value = "<Ћюба€>";
        end;
      end;
    end;
    —оздать‘ильтр—татей;
    --Edit1.Text                  = ‘ильтр—татей;
  end;

  func ѕоле√од√азетыѕриѕроверке(Cell :TemplateCell; Index :Integer;var Value :Variant) :Logical;
    if    Cell.Contents = "√од√азеты—"          then
      if Value>√од√азетыѕо                      then
        Message("√од начала периода издани€ газеты превышает год окончани€!");
        Return false;
      end;
    elsif Cell.Contents = "√од√азетыѕо"         then
      if √од√азеты—>Value                       then
        Message("√од начала периода издани€ газеты превышает год окончани€!");
        Return false;
      end;
    end;
    —оздать‘ильтр—татей;
    Result = True; 
  end;

  func ѕоле¬ыпускЋ√—ѕриѕроверке(Cell :TemplateCell; Index :Integer;var Value :Variant) :Logical;
    if    Cell.Contents = "¬ыпускЋ√—номер"      then
      if  Value<0 or Value>52                   then
        Message("Ќомер выпуска Ћ√— должен быть в пределах от 1 до 52!");
        Return false;
      end;
    end;
    —оздать‘ильтр—татей;
    Result = True; 
  end;

--}

end