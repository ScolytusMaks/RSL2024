class  '';

inclass public

  proc Создание (ЛГС :TextFile; ЗаписьЛГС :ВыпускЛГС);
    var j :Integer;
    ЛГС.Write   ("\par\page\pard" + ОригиналМакет.Стиль.Styl2 + "\qc ");
    ЛГС.Write   ("{\par\b С О Д Е Р Ж А Н И Е\b0\par}");
    ЛГС.WriteLn ("\ds2");
    ----Составление содержания---------------------------------------------------------------------------------
    for j = 1 .. ЗаписьЛГС.Содержание.Count do
      ЛГС.Write  ("\par\pard" + ОригиналМакет.Стиль.styl3 + "\ql ");
      ЛГС.Write  ("{" + ЗаписьЛГС.Содержание.Items[j].Глава + "\tab\tab ");
      --ЛГС.Write  (FixCode4(Str(ЗаписьЛГС.Содержание.Items[j].Страница)) + "}");
      if    (Length(Str(ЗаписьЛГС.Содержание.Items[j].Страница)) = 1) then
        ЛГС.Write  ("     " + Str(ЗаписьЛГС.Содержание.Items[j].Страница) + "}");
      elsif (Length(Str(ЗаписьЛГС.Содержание.Items[j].Страница)) = 2) then
        ЛГС.Write  ("   " + Str(ЗаписьЛГС.Содержание.Items[j].Страница) + "}");
      elsif (Length(str(ЗаписьЛГС.Содержание.Items[j].Страница)) = 3) then
        ЛГС.Write  (" " + Str(ЗаписьЛГС.Содержание.Items[j].Страница) + "}");
      else
        ЛГС.Write  (Str(ЗаписьЛГС.Содержание.Items[j].Страница) + "}");
      fi;
      ЛГС.WriteLn("\ds3");
    od;
    ----Создание ссылки на предисловие для выпусков N 2-52 ----------------------------------------------------
    ЛГС.WriteLn("\par");
    if (ЗаписьЛГС.ВыпускЛетописи > 1) then
      ЛГС.WriteLn ("\line\line\line");
      ЛГС.WriteLn ("\qc Предисловие - см. №1 \'abЛетописи газетных статей\'bb");
    fi;
  end;

end