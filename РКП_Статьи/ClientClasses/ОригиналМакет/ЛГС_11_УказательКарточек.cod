class "";

inclass

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  proc Создание(ЛГС             : TextFile;
                ЗаписьЛГС       : Record);
    var Q                       : Query;
    var k                       : integer;
    var СтрокаУказателя         : string;
    var Ном0                    : integer;
                ЛГС.WriteLn("\par\page\sect\sbknone\cols0");
                ЛГС.WriteLn("\par\pard"+ОригиналМакет.Стиль.styl2+"\qc ");
                ЛГС.WriteLn("{\b НУМЕРАЦИОННЫЙ УКАЗАТЕЛЬ \b}");
                ЛГС.WriteLn("\line");
                ЛГС.WriteLn("{\b БИБЛИОГРАФИЧЕСКИХ ЗАПИСЕЙ СТАТЕЙ, \b}");
                ЛГС.WriteLn("\line");
                ЛГС.WriteLn("{\b НА КОТОРЫЕ ИЗДАНЫ КАРТОЧКИ \b}");
                ЛГС.WriteLn("\ds2");
                ЛГС.WriteLn("");
                --
                ЛГС.WriteLn("\sect\sbknone\cols2\colsx0");                      --Начало секции о ДВУХ столбцах с нулевым промежутком
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\qj ");
                ЛГС.WriteLn("{");
    --выборка непосредственно при формировании макета
    Q                   = Query.Create([РКП_Статьи.Роспись]);
    Q.Filter            = "ГодЛетописи="+Str(ЗаписьЛГС.ГодЛетописи)+
                          " and ВыпускЛетописи="+Str(ЗаписьЛГС.ВыпускЛетописи)+
                          " and СтатусПК = true";
    Q.Order             = "НомерЗаписиВВыпускеГЛ";
    Q.Select;
      if  Q.Count>0                                     then
        Q.First;
        СтрокаУказателя = "";
        for k = 1..Q.Count                              do
          Ном0          = Q.Current.НомерЗаписиВВыпускеГЛ;
          if k=1                                        then
            СтрокаУказателя     = Str(Ном0);
          else
            СтрокаУказателя     = СтрокаУказателя+", "+Str(Ном0);
          end;
          Q.Next;
        end;--конец цикла в запросе по статьям
      end;--условие на непустой запрос
    Q.Close;
                --конец выборки
                ЛГС.WriteLn(СтрокаУказателя);
                ЛГС.WriteLn("\par}");
                ЛГС.WriteLn("\ds6\line\par");
                ЛГС.WriteLn("\sect\sbknone\cols0");
    end;
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

end