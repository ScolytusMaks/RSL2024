class "";

inclass
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  proc Создание(ЛГС             : TextFile;
                ЗаписьЛГС       : Record);
    var VS                      : Subtable;
    var j,i1                    : integer;
    var Литера0,Литера1         : string;
    var Гео0,Гео1               : string;
    var Тем0,Тем1               : string;
    var СтрокаУказателя         : string;
                ЛГС.WriteLn("\page");                                           --Новая страница
                ЛГС.WriteLn("\sect\sbknone\cols0");                             --Начало секции об обном столбце
                ЛГС.Write  ("\par\pard"+ОригиналМакет.Стиль.styl2+"\qc ");
                ЛГС.Write  ("{\b ГЕОГРАФИЧЕСКИЙ УКАЗАТЕЛЬ \b0\line}");
                ЛГС.WriteLn("\ds2");
                ЛГС.WriteLn("\sect\sbknone\cols2\colsx0");                      --Начало секции о ДВУХ столбцах с нулевым промежутком
                ЛГС.WriteLn("\line");
    VS          = ЗаписьЛГС.УказательГео.CreateSubtableView("Гео<>nil","Гео;Тематика;БибЗапись");
    for j = 1..VS.Count                                 do
      if      j = 1                                     then
        i1              = VS.IndexByNumber[j]+1;
        Литера1         = SubStr(VS.Items[i1].Гео,1,1);
        Гео1            = VS.Items[i1].Гео;
        Тем1            = VS.Items[i1].Тематика;
      else
        i1              = VS.IndexByNumber[j]+1;
        Литера0         = Литера1;
        Гео0            = Гео1;
        Тем0            = Тем1;
        Литера1         = SubStr(VS.Items[i1].Гео,1,1);
        Гео1            = VS.Items[i1].Гео;
        Тем1            = VS.Items[i1].Тематика;
      end;
      --строка литеры
      if Литера1<>Литера0                               then
        if      j > 1                                   then
                ЛГС.WriteLn("\line");
        end;
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl5+"\ql{\b "+Литера1+"\b0}\ds5\line");
      end;
      --строка места
      if    Гео1<>Гео0                                  then
        СтрокаУказателя = Гео1;
      --запись строки
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl4+"\ql {"+СтрокаУказателя+"}\ds4\line");
      end;
      --строка темы
      if    Гео1<>Гео0 or Тем1<>Тем0                    then
        СтрокаУказателя = " "+Тем1+" "+VS.Items[i1].БибЗапись;
      end;
      --запись строки
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl4+"\ql {"+СтрокаУказателя+"}\ds4\line");
    end;        --цикл по указателю
--== Пояснения к географическому указателю =========================================================================
                ЛГС.WriteLn("\sect\cols0");                                     --Начало секции об обном столбце
                ЛГС.Write  ("\par\pard"+ОригиналМакет.Стиль.styl2+"\qc ");
                ЛГС.Write  ("{\b Пояснение к географическому указателю \b0}");
                ЛГС.WriteLn("\ds2");
                ЛГС.WriteLn("\par\pard "+ОригиналМакет.Стиль.styl6+" \qj {");
                ЛГС.WriteLn("В заголовках рубрик и пояснениях к ним применяются следующие сокращения ");
                ЛГС.WriteLn('(в дополнение к ГОСТ 7.12-93 "Библиографическая запись. ');
                ЛГС.WriteLn('Общие требования и правила"):');
                ЛГС.WriteLn("}\ds6");
                --
                ЛГС.WriteLn("\sect\sbknone\cols2\colsx0");                      --Начало секции о ДВУХ столбцах с нулевым промежутком
                ЛГС.WriteLn("\line");
                --
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {бассейн - бас.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {вершина - верш.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {водохранилище - водохран.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {возвышенность - возвыш.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {месторождение - местрожд.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {низменность - низм.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {остров - о-в}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {плоскогорье - плоског.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {побережье - побер.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {полуостров - п-ов}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {пустыня - пуст.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {равнина - равн.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {река - р.}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {территориально-производственный комплекс - ТПК}\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ds6\line");
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl6+"\ql {хребет - хр.}\ds6\line");
                ЛГС.WriteLn("\sect\sbknone\cols2\colsx0");
                ЛГС.WriteLn("\page");
  end;
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


end