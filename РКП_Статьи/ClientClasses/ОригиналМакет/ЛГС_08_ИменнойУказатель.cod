class "";

inclass
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  proc Создание(ЛГС             : TextFile;
                ЗаписьЛГС       : Record);
    var VS                      : Subtable;
    var j,i1                    : integer;
    var Литера0,Литера1         : string;
    var Персона0,Персона1       : string;
    var СтрокаУказателя         : string;

                ЛГС.WriteLn("\page");                                           --Новая страница
                ЛГС.WriteLn("\sect\sbknone\cols0");                             --Начало секции об обном столбце
                ЛГС.Write  ("\par\pard"+ОригиналМакет.Стиль.styl2+"\qc ");
                ЛГС.Write  ("{\b ИМЕННОЙ УКАЗАТЕЛЬ \b0\line}");
                ЛГС.WriteLn("\ds2");
                ЛГС.WriteLn("\sect\sbknone\cols3\colsx0");                      --Начало секции о тех столбцах с нулевым промежутком
                ЛГС.WriteLn("\line");
    VS          = ЗаписьЛГС.УказательИмен.CreateSubtableView("ФИО<>nil","ФИО;БибЗапись");
    for j = 1..VS.Count                                 do
      if j = 1                                          then
        i1              = VS.IndexByNumber[j]+1;
        Литера1         = SubStr(VS.Items[i1].ФИО,1,1);
        Персона1        = VS.Items[i1].ФИО;
      else
        i1              = VS.IndexByNumber[j]+1;
        Литера0         = Литера1;
        Персона0        = Персона1;
        Литера1         = SubStr(VS.Items[i1].ФИО,1,1);
        Персона1        = VS.Items[i1].ФИО;
      end;
      if Литера1<>Литера0                               then
      if      j > 1                                     then
                ЛГС.WriteLn("\line");
      end;
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl5+"\ql{\b "+Литера1+"\b0}\ds5\line");
      end;
      if Персона1<>Персона0                             then
        СтрокаУказателя = Персона1+" "+VS.Items[i1].БибЗапись;
        СтрокаУказателя = РКП_Статьи.ОригиналМакет.ОбработкаТекста.ВставкаСпецСимволов(СтрокаУказателя);
      else
      end;
                ЛГС.WriteLn(ОригиналМакет.Стиль.styl4+"\ql {"+СтрокаУказателя+"}\ds4\line");
    end;        --цикл по указателю ФИО

                ЛГС.WriteLn("\sect\cols0");                                     --Начало секции об обном столбце,
                ЛГС.Write  ("\par\pard"+ОригиналМакет.Стиль.styl2+"\qc ");      --сепарирующей именной указатель
                ЛГС.Write  ("{ }");                                             --пустая строка
                ЛГС.WriteLn("\ds2");
  end;
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


end